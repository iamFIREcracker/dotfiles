(cg:define-guesser apt-install
    ("(sudo apt install [^ ]+)" (apt-cmd))
  (format NIL "~a " apt-cmd))

(cg:define-guesser br
    ;; https://gist.github.com/gruber/249502
    ("((?i)\\b((?:[a-z][\\w-]+:(?:/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/)(?:[^\\s()<>]+|\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\))+(?:\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\)|[^\\s`!()\\[\\]{};:'\".,<>?«»“”‘’])))"
     (url))
  (format NIL "br '~a' " url))

(cg:define-guesser git-b-git-delete
    ("^\\*?\\s+([^ ]+)\\s+([a-f0-9]{7,9})\\s(\\[gone]\\s*.*)" (branch commit rest))
  (format NIL "git branch -d '~a' # ~a -> ~a" branch commit rest))

(cg:define-guesser git-b-git-checkout
    ;; XXX would be nice if we could define a documentation like
    ;; argument, that we could then parse and maybe run tests against
    ("^\\*?\\s+([^ ]+)\\s+([a-f0-9]{7,10})\\s(.*)" (branch commit rest))
  (format NIL "git checkout '~a' # ~a -> ~a" branch commit rest))

(cg:define-guesser git-branch-delete
    ("'(git branch -D [^ ]+)'" (git-cmd))
  (format NIL "~a" git-cmd))

(cg:define-guesser kill-kill9
    ("kill ([0-9]+)" (pid))
  (format NIL "kill -9 '~a'" pid))

(cg:define-guesser ports-kill
    ("^(\\w+)\\s+([0-9]+)\\s+(\\w+)\\s+(\\w+)" (command pid user fd))
  (format NIL "kill '~a' # FD ~a locked by ~a (~a)" pid fd command user))

(cg:define-guesser psg-kill
    ("^([0-9]+)\\s+(.+)" (pid command))
  (format NIL "kill '~a' # ~a " pid command))
