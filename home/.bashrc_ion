# Fast edits {{{

function eb1i() { vim ~/opt/bunny1/b1_ion.py; }
function ebi() { vim ~/.bashrc_ion; }
function ek() { vim /cygdrive/c/Users/mlandi/Google\ Drive/personal/KeyMappings.ahk; }

# }}}
# Awk {{{

function delta() {
    awk -f ~/h/Google\ Drive/personal/delta.awk
}
mq_slowness() {
    awk -f ~/h/Google\ Drive/personal/mq_slowness.awk
}

split_runs() {
    awk -f ~/h/Google\ Drive/personal/split_runs.awk
}

# }}}

function b1i() { ~/opt/bunny1/venv/bin/python ~/opt/bunny1/b1_ion.py --test "$*"; }
function cm() { cygstart "C:\Program Files\CommitMonitor\CommitMonitor.exe"; }
function cts_reconfigure() {
    (true && \
        cd /cygdrive/c/Users/mlandi/workspace/xoms-git/oms-deploy && \
        rsync -av src/test/resources/cts.init ion@lilith.fssnet.internal:PLATFORM_LILITH/DM_LILITH_OMS_STATIC/wrk/CTS_OMS_CI && \
        ssh ion@lilith.fssnet.internal "psg cts | cuts -f1 | xargs kill && exit 0")
}
function cyg_get() { cyg_setup -q -P "$1"; }
function cyg_setup() { cygstart 'C:\Users\mlandi\Downloads\setup-x86_64.exe' "$@"; }
function d() {
    if [ x"$1" == x"isearch" ]; then
        curl -X GET http://10.100.80.48:5000/v2/_catalog 2> /dev/null | json_pp | hl "${@:2}"
    else
        sudo docker "$@"
    fi
}
function gce() { gc '(	at |xception|ERROR)' "$@"; }
function fetchdocs() { m live-documentation-fetcher:fetch -DtestCasesDirectorySplit=$0; }
function fuck_cmd() {
    cmd /c start "$@"
}
function last_log() { $(which ls) -t /cygdrive/c/Users/mlandi/workspace/xoms-git/$1/LOGS/OMS* | hn 1; }
function last_log_mmi() { $(which ls) -t /cygdrive/c/Users/mlandi/AppData/Roaming/ION\ Trading/MMI.NET/lilith_20000/Workspaces/lilith_20000_mlandi/LOGS/MMI.NET* | hn 1; }
function last_run() { tail_from_start $(last_log $1); }
function last_run_mmi() { tail_from_start $(last_log_mmi); }
function lr { last_run "$@"; }
function mmi() {
    ~/workspace/oms.net/output/mmi.exe \
        -themes=true -EnabledThemesDemoLevelBase \
        "$@"
}
function mmi_trader() {
    mmi \
        -auth=secure -pwd=mlandi -user=mlandi \
        -env=lilith_20000 -workspace=lilith_20000_mlandi
}
function mmi_sales() {
    mmi \
        -auth=secure -pwd=mlandi -user=mlandi_sales \
        -env=lilith_20000_sales -workspace=lilith_20000_mlandi_sales
}
function omsparents() {
    (true && \
        cd /cygdrive/c/Users/mlandi/workspace/xoms-git/oms-parent && \
            m clean install && \
        cd /cygdrive/c/Users/mlandi/workspace/xoms-git/oms-parent-tests && \
            m clean install)
}
function omscodegen() {
    (true && \
        cd /cygdrive/c/Users/mlandi/workspace/xoms-git/oms-common && \
            m clean codegen:codegen install && \
        cd /cygdrive/c/Users/mlandi/workspace/xoms-git/oms_wm && \
            m clean dependency:unpack-dependencies@unpack-codegen codegen:codegen)
}
function omstest() {
    (true && \
        cd /cygdrive/c/Users/mlandi/workspace/xoms-git/oms-common && \
            m integration-test && \
        cd /cygdrive/c/Users/mlandi/workspace/xoms-git/oms_wm && \
            m integration-test && \
        cd /cygdrive/c/Users/mlandi/workspace/xoms-git/oms_capture && \
            m integration-test && \
        cd /cygdrive/c/Users/mlandi/workspace/xoms-git/oms_rs && \
            m integration-test)
}
# Robotframework {{{

function rf() {
    local _test=${1:-*}
    local _suite=${2:-stuff}
    local _split=${3:-stuff}
    local _platform=${4:-local_mlandi}

    _JAVA_OPTIONS="$_JAVA_OPTIONS -Djava.awt.headless=false" \
        m \
        -Dtest.name="$_test" \
        -Dsuite.test="$_suite" \
        -DtestCasesDirectorySplit="$_split" \
        -Denv.platform="$_platform" \
        -Dwebdriver.chrome.driver="src\test\chromedriver.exe" \
        -Dwebdriver.firefox.bin="C:\Program Files (x86)\Mozilla Firefox ESR\firefox.exe" \
        -Dwebdriver.ie.bin="C:\Program Files\Internet Explorer\iexplore.exe" \
        integration-test
    rfglog
    rflog
}
function rfcb() {
    cb | J | cb
}
function rfi() {
    local _test
    local _suite
    local _split
    read -p "test [${GREEN}${_RFI_TEST:-*}${D}]: " _test
    read -p "suite [${PINK}${_RFI_SUITE:-stuff}${D}]: " _suite
    read -p "split [${ORANGE}${_RFI_SPLIT:-stuff}${D}]: " _split

    export _RFI_TEST=${_test:-${_RFI_TEST}}
    export _RFI_SUITE=${_suite:-${_RFI_SUITE}}
    export _RFI_SPLIT=${_split:-${_RFI_SPLIT}}

    echo
    echo "rf '${GREEN}${_RFI_TEST:-*}${D}' '${PINK}${_RFI_SUITE}${D}' '${ORANGE}${_RFI_SPLIT}${D}'"

    rf "${_RFI_TEST}" "${_RFI_SUITE}" "${_RFI_SPLIT}"
}
function rfglog() {
    rebot.bat \
        --noncritical unstable \
        --report NONE \
        --outputdir $(cygpath -w target/robotframework-reports) \
        $(cygpath -w target/robotframework-reports/output.xml)
}
function rflog() { cygstart $(cygpath -a target/robotframework-reports/log.html); }

# }}}
function ride() {
    cygstart "C:\Python27\pythonw.exe" -c "from robotide import main; main()";
}
# Scum {{{

_scum=$(which scum)
function scum() {
    "${_scum}" "$@" | \
        sed --unbuffered \
            -e "s/Warning: \(.*\)/$ORANGE\1$D/g" \
            -e "s/Error: \(.*\)/$RED\1$D/g"
}

# }}}
function sysadmin() {
    cygstart \
        "C:\Program Files\ION Trading\System Administrator 227p6d2 (64-bit)\SystemAdministrator.exe" \
        "$@"
}
function sysadmin_lilith() {
    sysadmin \
        -auth=secure -pwd=mlandi -user=mlandi \
        -env=lilith_20000 -workspace=lilith_20000_mkv
}
function sysadmin_qsearch() {
    sysadmin \
        -auth=secure -pwd=qSe@rch123 -user=qsearch \
        -env=qsearch.iontrading.com -workspace=lilith_20000_mkv
}
function sysadmin_pimatlanw01() {
    sysadmin \
        -auth=secure -pwd=mkvpwd -user=mkv \
        -env=pimatlanw01 -workspace=pimatlanw01_mkv
}
function tail_from_start() { tail_from 'Application {INFO} Action {START}' "$@"; }
function to_sheet_fcall() {
    # 04:45:28:438|0501-00102:TracingFunctionListenerFactory: {INFO} FCall Start <-- {190} FName {OWM1_VCMIOrderAdd181} Comp {OC1} User {default user} InstrumentId {} Verb {Sell} Price {0.0} QtyShown {0.0} QtyTot {1000.0} Type {Market} TimeInForce {FAK} IsSoft {0} Attribute {0} CustomerInfo {cust info} FreeText {free text} StopCond {0} StopId {} StopPrice {0.0} Optional { CPMember {AASAKAWA} FXTypeStr {Swap} L1_DateSettlRequested {20160208} S0_CurrencyStr {EUR} S1_CurrencyStr {USD} OnBehalfOfComponentName {ROBOT_OMS1} }
    # =OWM1_VCMIOrderAdd181('default user', '', 'Sell', 0.0, 0.0, 1000.0, 'Market', 'FAK', 0, 0, 'cust info', 'free text', 0, '', 0.0, 'CPMember', 'AASAKAWA', 'FXTypeStr', 'Swap', 'L1_DateSettlRequested', 20160208, 'S0_CurrencyStr', 'EUR', 'S1_CurrencyStr', 'USD', 'OnBehalfOfComponentName', 'ROBOT_OMS1')
    echo 
}
# Components {{{

function router() {
    (
    cd /cygdrive/c/Users/mlandi/opt/router_m106p4;
    ./mkvrouter_m106p4.sh
    )
}
function webserver() {
    (
    cd /cygdrive/c/Users/mlandi/opt/ION_WEB_SERVER117/bin;
    ./IonWebServer.bat;
    )
}
function webstreaming() {
    (
    cd /cygdrive/c/Users/mlandi/opt/ION_WEB_STREAMING103/bin;
    ./IonWebStreamingServer.bat
    )
}

# }}}
# Hosts {{{

pimatlanw01() {
    ssh -R 5556:localhost:5556 mlandi@PIMATLANW01.iontrading.com
}
pimatlanw01linux() {
    ssh -R 5556:localhost:5556 -p 10022 vagrant@PIMATLANW01.iontrading.com
}
lndct01() { s ion@lnd-ct-01.iontrading.com; }
axton() { s ion@axton.fssnet.internal "cd jenkins-axton/jobs"; }
coral() { s ion@coral.fssnet.internal; }
lilith() { s ion@lilith.fssnet.internal "cd PLATFORM_LILITH"; }
ipse() {
    sshs app-dev@lnd-ipse-dev-03.iontrading.com \
        -t "cd /opt/ion/DEVPlatform; bash --login"
}

dmondra() {
    sshs ion@ondra.iontrading.com \
        -t "cd /export/saltest/test/21000; bash --login"
}

dsondra() {
    sshs ion@ondra.iontrading.com \
        -t "cd /export/saltest/test/20000; bash --login"
}

delhiqa() {
    sshs delhi_qa@192.168.46.176 \
        -t "cd BIMI_FX; bash --login"
}
# }}}

export PATH="/usr/sbin:$PATH"
export PATH="${HOME}/h/AppData/Roaming/npm:$PATH"

export PATH="/home/mlandi/perl5/bin${PATH+:}${PATH}"; export PATH;
export PERL5LIB="/home/mlandi/perl5/lib/perl5${PERL5LIB+:}${PERL5LIB}"; export PERL5LIB;
export PERL_LOCAL_LIB_ROOT="/home/mlandi/perl5${PERL_LOCAL_LIB_ROOT+:}${PERL_LOCAL_LIB_ROOT}"; export PERL_LOCAL_LIB_ROOT;
export PERL_MB_OPT="--install_base \"/home/mlandi/perl5\""; export PERL_MB_OPT;
export PERL_MM_OPT="INSTALL_BASE=/home/mlandi/perl5"; export PERL_MM_OPT;

# disable remote-control-system related stuff
export PROMPT_NO_RCS=true
